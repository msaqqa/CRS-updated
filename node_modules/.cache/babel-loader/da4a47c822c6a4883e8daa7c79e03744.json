{"ast":null,"code":"import _objectSpread from\"E:\\\\CSR-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"E:\\\\CSR-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"E:\\\\CSR-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"E:\\\\CSR-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\CSR-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"E:\\\\CSR-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"E:\\\\CSR-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component,createContext}from'react';import history from\"../../history\";import axios from\"axios\";// importing toastify module\nimport{toast}from'react-toastify';import'react-toastify/dist/ReactToastify.css';toast.configure();// context\nvar UserContext=createContext();// provider\nvar UserProvider=/*#__PURE__*/function(_Component){_inherits(UserProvider,_Component);var _super=_createSuper(UserProvider);function UserProvider(){var _this;_classCallCheck(this,UserProvider);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={url:\"http://excodeteam.com/crs/api/v1\",categories:[],countries:[],user:{},loading:false,forgetStatus:0};_this.componentDidMount=function(){localStorage.getItem(\"user\")?_this.setState({user:JSON.parse(localStorage.getItem(\"user\"))}):_this.setState({user:{}});};_this.getCategories=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios({method:'get',url:\"\".concat(_this.state.url,\"/user/register\")}).then(function(res){var data=res.data.data;var categories=data.categories;_this.setState({categories:categories});console.log(res);},function(error){console.log(error);});case 2:case\"end\":return _context.stop();}}},_callee);}));_this.getCountries=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios({method:'get',url:\"https://restcountries.eu/rest/v2/all\"}).then(function(res){var countries=res.data.map(function(item){return item.name;});_this.setState({countries:countries});console.log(res);},function(error){console.log(error);});case 2:case\"end\":return _context2.stop();}}},_callee2);}));_this.userRegister=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(values){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_this.setState({loading:true});console.log(\"userRegister\",values);_context3.next=4;return axios({method:'post',url:\"\".concat(_this.state.url,\"/user/register\"),data:_objectSpread({},values)}).then(function(res){var _res$data=res.data,code=_res$data.code,status=_res$data.status,message=_res$data.message;if(code==200&&status===true){toast.success(message,{autoClose:2000,position:toast.POSITION.TOP_CENTER});history.push(\"/login\");}else{toast.error(message,{position:toast.POSITION.TOP_CENTER});}console.log(res);},function(error){console.log(error);});case 4:_this.setState({loading:false});case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x){return _ref3.apply(this,arguments);};}();_this.userLogin=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(values){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_this.setState({loading:true});_context4.next=3;return axios({method:'post',url:\"\".concat(_this.state.url,\"/user/login\"),data:_objectSpread({},values)}).then(function(res){var _res$data2=res.data,code=_res$data2.code,status=_res$data2.status,message=_res$data2.message,token=_res$data2.accessToken,user=_res$data2.user;if(code===\"200\"&&status===true){var type=user.type,photo=user.photo,name=user.name,birthDate=user.birthDate,country_id=user.country_id;_this.setState({user:_objectSpread({token:token},user)});var dashboardUrl=type===\"2\"?\"/employee/dashboard\":\"/employer/dashboard\";type===\"0\"?window.open('/admin','_blank'):history.push(dashboardUrl);localStorage.setItem(\"user\",JSON.stringify({token:token,type:type,photo:photo,name:name,birthDate:birthDate,country_id:country_id}));toast.success(message,{autoClose:2000,position:toast.POSITION.TOP_CENTER});}else{toast.error(message,{position:toast.POSITION.TOP_CENTER});}console.log(res);},function(error){toast.error(\"There was an error. Please try again...\",{autoClose:2000,position:toast.POSITION.TOP_CENTER});console.log(error);});case 3:_this.setState({loading:false});case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x2){return _ref4.apply(this,arguments);};}();_this.userRefresh=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(user){var type,photo,name,birthDate,country_id,token;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:type=user.type,photo=user.photo,name=user.name,birthDate=user.birthDate,country_id=user.country_id;token=_this.state.user.token;_context5.next=4;return _this.setState({user:_objectSpread({token:token},user)});case 4:localStorage.setItem(\"user\",JSON.stringify({token:token,type:type,photo:photo,name:name,birthDate:birthDate,country_id:country_id}));case 5:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x3){return _ref5.apply(this,arguments);};}();_this.userLogout=function(){_this.setState({user:{}});localStorage.removeItem(\"user\");history.push(\"/login\");};_this.changePassword=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(_ref6){var oldPassword,newPassword;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:oldPassword=_ref6.oldPassword,newPassword=_ref6.newPassword;_context6.next=3;return axios({method:'post',url:\"\".concat(_this.state.url,\"/change_password\"),headers:{Authorization:\"Bearer \".concat(_this.state.user.token)},data:{\"old_password\":oldPassword,\"new_password\":newPassword}}).then(function(res){var _res$data3=res.data,code=_res$data3.code,status=_res$data3.status,message=_res$data3.message;if(code===200&&status===true){toast.success(message,{autoClose:2000,position:toast.POSITION.TOP_CENTER});}else{toast.error(message,{autoClose:2000,position:toast.POSITION.TOP_CENTER});}console.log(res);},function(error){console.log(error);});case 3:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x4){return _ref7.apply(this,arguments);};}();_this.forgotPassword=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(values){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return axios({method:'post',url:\"\".concat(_this.state.url,\"/user/forgot_password\"),data:values}).then(function(res){var _res$data4=res.data,code=_res$data4.code,status=_res$data4.status,message=_res$data4.message;if(code===200&&status===true){_this.setState({forgetStatus:1});toast.success(message,{autoClose:2000,position:toast.POSITION.TOP_CENTER});}else{toast.error(message,{autoClose:2000,position:toast.POSITION.TOP_CENTER});}console.log(res);},function(error){console.log(error);});case 2:case\"end\":return _context7.stop();}}},_callee7);}));return function(_x5){return _ref8.apply(this,arguments);};}();_this.sendCode=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(values){return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return axios({method:'post',url:\"\".concat(_this.state.url,\"/user/send_code\"),data:values}).then(function(res){var _res$data5=res.data,code=_res$data5.code,status=_res$data5.status,message=_res$data5.message;if(code===200&&status===true){_this.setState({forgetStatus:2});toast.success(message,{autoClose:2000,position:toast.POSITION.TOP_CENTER});}else{toast.error(message,{autoClose:2000,position:toast.POSITION.TOP_CENTER});}console.log(res);},function(error){console.log(error);});case 2:case\"end\":return _context8.stop();}}},_callee8);}));return function(_x6){return _ref9.apply(this,arguments);};}();_this.resetPassword=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(values){return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return axios({method:'post',url:\"\".concat(_this.state.url,\"/user/reset_password\"),data:values}).then(function(res){var _res$data6=res.data,code=_res$data6.code,status=_res$data6.status,message=_res$data6.message;if(code===200&&status===true){_this.setState({forgetStatus:0});history.push(\"/login\");toast.success(message,{autoClose:2000,position:toast.POSITION.TOP_CENTER});}else{toast.error(message,{autoClose:2000,position:toast.POSITION.TOP_CENTER});}console.log(res);},function(error){console.log(error);});case 2:case\"end\":return _context9.stop();}}},_callee9);}));return function(_x7){return _ref10.apply(this,arguments);};}();return _this;}_createClass(UserProvider,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(UserContext.Provider,{value:_objectSpread(_objectSpread({},this.state),{},{getCategories:this.getCategories,getCountries:this.getCountries,userRegister:this.userRegister,userLogin:this.userLogin,userRefresh:this.userRefresh,userLogout:this.userLogout,changePassword:this.changePassword,forgotPassword:this.forgotPassword,sendCode:this.sendCode,resetPassword:this.resetPassword})},this.props.children);}}]);return UserProvider;}(Component);// consumer\nvar UserConsumer=UserContext.Consumer;export{UserConsumer,UserContext};export default UserProvider;","map":{"version":3,"sources":["E:/CSR-master/src/client/context/user.js"],"names":["React","Component","createContext","history","axios","toast","configure","UserContext","UserProvider","state","url","categories","countries","user","loading","forgetStatus","componentDidMount","localStorage","getItem","setState","JSON","parse","getCategories","method","then","res","data","console","log","error","getCountries","map","item","name","userRegister","values","code","status","message","success","autoClose","position","POSITION","TOP_CENTER","push","userLogin","token","accessToken","type","photo","birthDate","country_id","dashboardUrl","window","open","setItem","stringify","userRefresh","userLogout","removeItem","changePassword","oldPassword","newPassword","headers","Authorization","forgotPassword","sendCode","resetPassword","props","children","UserConsumer","Consumer"],"mappings":"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","sourcesContent":["import React, { Component, createContext } from 'react';\nimport history from \"../../history\";\nimport axios from \"axios\";\n// importing toastify module\nimport { toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\ntoast.configure();\n\n// context\nconst UserContext = createContext();\n\n// provider\nclass UserProvider extends Component {\n    state = {\n        url: \"http://excodeteam.com/crs/api/v1\",\n        categories: [],\n        countries: [],\n        user: {},\n        loading: false,\n        forgetStatus: 0\n    }\n\n    componentDidMount = () => {\n        localStorage.getItem(\"user\")\n            ? this.setState({ user: JSON.parse(localStorage.getItem(\"user\")) })\n            : this.setState({ user: {} });\n    }\n\n    getCategories = async () => {\n        await axios({\n            method: 'get',\n            url: `${this.state.url}/user/register`,\n        }).then(\n            res => {\n                const { data } = res.data;\n                const { categories } = data;\n                this.setState({ categories });\n                console.log(res);\n            },\n            error => {\n                console.log(error);\n            }\n        )\n    }\n\n    getCountries = async () => {\n        await axios({\n            method: 'get',\n            url: \"https://restcountries.eu/rest/v2/all\",\n        }).then(\n            res => {\n                const countries = res.data.map(item => {\n                    return item.name\n                })\n                this.setState({ countries });\n                console.log(res);\n            },\n            error => {\n                console.log(error);\n            }\n        )\n    }\n\n\n    userRegister = async (values) => {\n        this.setState({ loading: true });\n        console.log(\"userRegister\", values);\n        await axios({\n            method: 'post',\n            url: `${this.state.url}/user/register`,\n            data: { ...values },\n        }).then(\n            res => {\n                const { code, status, message } = res.data;\n                if (code == 200 && status === true) {\n                    toast.success(message, { autoClose: 2000, position: toast.POSITION.TOP_CENTER });\n                    history.push(\"/login\");\n                } else {\n                    toast.error(message, { position: toast.POSITION.TOP_CENTER });\n                }\n                console.log(res);\n            },\n            error => {\n                console.log(error);\n            }\n        )\n        this.setState({ loading: false });\n    }\n\n    userLogin = async (values) => {\n        this.setState({ loading: true });\n        await axios({\n            method: 'post',\n            url: `${this.state.url}/user/login`,\n            data: { ...values },\n        }).then(\n            res => {\n                const { code, status, message, accessToken: token, user } = res.data;\n                if (code === \"200\" && status === true) {\n                    const { type, photo, name, birthDate, country_id } = user;\n                    this.setState({\n                        user: { token, ...user }\n                    });\n                    const dashboardUrl = (type === \"2\" ? \"/employee/dashboard\" : \"/employer/dashboard\");\n                    type === \"0\" ? window.open('/admin', '_blank') : history.push(dashboardUrl);\n                    localStorage.setItem(\"user\", JSON.stringify({ token, type, photo, name, birthDate, country_id }));\n                    toast.success(message, { autoClose: 2000, position: toast.POSITION.TOP_CENTER });\n                } else {\n                    toast.error(message, { position: toast.POSITION.TOP_CENTER });\n                }\n                console.log(res);\n\n            },\n            error => {\n                toast.error(\"There was an error. Please try again...\", { autoClose: 2000, position: toast.POSITION.TOP_CENTER })\n                console.log(error);\n            }\n        )\n        this.setState({ loading: false });\n    }\n\n    userRefresh = async (user) => {\n        const { type, photo, name, birthDate, country_id } = user;\n        const { token } = this.state.user;\n        await this.setState({ user: { token, ...user } });\n        localStorage.setItem(\"user\", JSON.stringify({ token, type, photo, name, birthDate, country_id }));\n    }\n\n    userLogout = () => {\n        this.setState({ user: {} });\n        localStorage.removeItem(\"user\");\n        history.push(\"/login\");\n    };\n\n    changePassword = async ({ oldPassword, newPassword }) => {\n        await axios({\n            method: 'post',\n            url: `${this.state.url}/change_password`,\n            headers: { Authorization: `Bearer ${this.state.user.token}` },\n            data: { \"old_password\": oldPassword, \"new_password\": newPassword },\n        }).then(\n            res => {\n                const { code, status, message } = res.data;\n                if (code === 200 && status === true) {\n                    toast.success(message, { autoClose: 2000, position: toast.POSITION.TOP_CENTER });\n                } else {\n                    toast.error(message, { autoClose: 2000, position: toast.POSITION.TOP_CENTER })\n                }\n                console.log(res);\n            },\n            error => {\n                console.log(error);\n            }\n        )\n    }\n\n    forgotPassword = async (values) => {\n        await axios({\n            method: 'post',\n            url: `${this.state.url}/user/forgot_password`,\n            data: values,\n        }).then(\n            res => {\n                const { code, status, message } = res.data;\n                if (code === 200 && status === true) {\n                    this.setState({ forgetStatus: 1 })\n                    toast.success(message, { autoClose: 2000, position: toast.POSITION.TOP_CENTER });\n                } else {\n                    toast.error(message, { autoClose: 2000, position: toast.POSITION.TOP_CENTER })\n                }\n                console.log(res);\n            },\n            error => {\n                console.log(error);\n            }\n        )\n    }\n\n    sendCode = async (values) => {\n        await axios({\n            method: 'post',\n            url: `${this.state.url}/user/send_code`,\n            data: values,\n        }).then(\n            res => {\n                const { code, status, message } = res.data;\n                if (code === 200 && status === true) {\n                    this.setState({ forgetStatus: 2 })\n                    toast.success(message, { autoClose: 2000, position: toast.POSITION.TOP_CENTER });\n                } else {\n                    toast.error(message, { autoClose: 2000, position: toast.POSITION.TOP_CENTER })\n                }\n                console.log(res);\n            },\n            error => {\n                console.log(error);\n            }\n        )\n    }\n\n    resetPassword = async (values) => {\n        await axios({\n            method: 'post',\n            url: `${this.state.url}/user/reset_password`,\n            data: values,\n        }).then(\n            res => {\n                const { code, status, message } = res.data;\n                if (code === 200 && status === true) {\n                    this.setState({ forgetStatus: 0 })\n                    history.push(\"/login\");\n                    toast.success(message, { autoClose: 2000, position: toast.POSITION.TOP_CENTER });\n                } else {\n                    toast.error(message, { autoClose: 2000, position: toast.POSITION.TOP_CENTER })\n                }\n                console.log(res);\n            },\n            error => {\n                console.log(error);\n            }\n        )\n    }\n\n    render() {\n        return (\n            <UserContext.Provider value={{\n                ...this.state,\n                getCategories: this.getCategories,\n                getCountries: this.getCountries,\n                userRegister: this.userRegister,\n                userLogin: this.userLogin,\n                userRefresh: this.userRefresh,\n                userLogout: this.userLogout,\n                changePassword: this.changePassword,\n\n                forgotPassword: this.forgotPassword,\n                sendCode: this.sendCode,\n                resetPassword: this.resetPassword\n            }}>\n                {this.props.children}\n            </UserContext.Provider>\n        )\n    }\n}\n\n// consumer\nconst UserConsumer = UserContext.Consumer;\n\nexport { UserConsumer, UserContext };\nexport default UserProvider;"]},"metadata":{},"sourceType":"module"}