{"ast":null,"code":"var _jsxFileName = \"E:\\\\CSR-master\\\\src\\\\client\\\\context\\\\user.js\";\nimport React, { Component, createContext } from 'react';\nimport history from \"../../history\";\nimport axios from \"axios\"; // importing toastify module\n\nimport { toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\ntoast.configure(); // context\n\nconst UserContext = createContext(); // provider\n\nclass UserProvider extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      url: \"https://joodya.com/crs/api/v1\",\n      categories: [],\n      countries: [],\n      user: {},\n      loading: false,\n      forgetStatus: 0\n    };\n\n    this.componentDidMount = () => {\n      localStorage.getItem(\"user\") ? this.setState({\n        user: JSON.parse(localStorage.getItem(\"user\"))\n      }) : this.setState({\n        user: {}\n      });\n    };\n\n    this.getCategories = async () => {\n      await axios({\n        method: 'get',\n        url: `${this.state.url}/user/register`\n      }).then(res => {\n        const {\n          data\n        } = res.data;\n        const {\n          categories\n        } = data;\n        this.setState({\n          categories\n        });\n        console.log(res);\n      }, error => {\n        console.log(error);\n      });\n    };\n\n    this.getCountries = async () => {\n      await axios({\n        method: 'get',\n        url: \"https://restcountries.eu/rest/v2/all\"\n      }).then(res => {\n        const countries = res.data.map(item => {\n          return item.name;\n        });\n        this.setState({\n          countries\n        });\n        console.log(res);\n      }, error => {\n        console.log(error);\n      });\n    };\n\n    this.userRegister = async values => {\n      this.setState({\n        loading: true\n      });\n      console.log(\"userRegister\", values);\n      await axios({\n        method: 'post',\n        url: `${this.state.url}/user/register`,\n        data: { ...values\n        }\n      }).then(res => {\n        const {\n          code,\n          status,\n          message\n        } = res.data;\n\n        if (code == 200 && status === true) {\n          toast.success(message, {\n            autoClose: 2000,\n            position: toast.POSITION.TOP_CENTER\n          });\n          history.push(\"/login\");\n        } else {\n          toast.error(message, {\n            position: toast.POSITION.TOP_CENTER\n          });\n        }\n\n        console.log(res);\n      }, error => {\n        console.log(error);\n      });\n      this.setState({\n        loading: false\n      });\n    };\n\n    this.userLogin = async values => {\n      this.setState({\n        loading: true\n      });\n      await axios({\n        method: 'post',\n        url: `${this.state.url}/user/login`,\n        data: { ...values\n        }\n      }).then(res => {\n        const {\n          code,\n          status,\n          message,\n          accessToken: token,\n          user\n        } = res.data;\n\n        if (code === \"200\" && status === true) {\n          const {\n            type,\n            photo,\n            name,\n            birthDate,\n            country_id\n          } = user;\n          this.setState({\n            user: {\n              token,\n              ...user\n            }\n          });\n          const dashboardUrl = type === \"2\" ? \"/employee/dashboard\" : \"/employer/dashboard\";\n          type === \"0\" ? window.open('/admin', '_blank') : history.push(dashboardUrl);\n          localStorage.setItem(\"user\", JSON.stringify({\n            token,\n            type,\n            photo,\n            name,\n            birthDate,\n            country_id\n          }));\n          toast.success(message, {\n            autoClose: 2000,\n            position: toast.POSITION.TOP_CENTER\n          });\n        } else {\n          toast.error(message, {\n            position: toast.POSITION.TOP_CENTER\n          });\n        }\n\n        console.log(res);\n      }, error => {\n        toast.error(\"There was an error. Please try again...\", {\n          autoClose: 2000,\n          position: toast.POSITION.TOP_CENTER\n        });\n        console.log(error);\n      });\n      this.setState({\n        loading: false\n      });\n    };\n\n    this.userRefresh = async user => {\n      const {\n        type,\n        photo,\n        name,\n        birthDate,\n        country_id\n      } = user;\n      const {\n        token\n      } = this.state.user;\n      await this.setState({\n        user: {\n          token,\n          ...user\n        }\n      });\n      localStorage.setItem(\"user\", JSON.stringify({\n        token,\n        type,\n        photo,\n        name,\n        birthDate,\n        country_id\n      }));\n    };\n\n    this.userLogout = () => {\n      this.setState({\n        user: {}\n      });\n      localStorage.removeItem(\"user\");\n      history.push(\"/login\");\n    };\n\n    this.changePassword = async _ref => {\n      let {\n        oldPassword,\n        newPassword\n      } = _ref;\n      await axios({\n        method: 'post',\n        url: `${this.state.url}/change_password`,\n        headers: {\n          Authorization: `Bearer ${this.state.user.token}`\n        },\n        data: {\n          \"old_password\": oldPassword,\n          \"new_password\": newPassword\n        }\n      }).then(res => {\n        const {\n          code,\n          status,\n          message\n        } = res.data;\n\n        if (code === 200 && status === true) {\n          toast.success(message, {\n            autoClose: 2000,\n            position: toast.POSITION.TOP_CENTER\n          });\n        } else {\n          toast.error(message, {\n            autoClose: 2000,\n            position: toast.POSITION.TOP_CENTER\n          });\n        }\n\n        console.log(res);\n      }, error => {\n        console.log(error);\n      });\n    };\n\n    this.forgotPassword = async values => {\n      await axios({\n        method: 'post',\n        url: `${this.state.url}/user/forgot_password`,\n        data: values\n      }).then(res => {\n        const {\n          code,\n          status,\n          message\n        } = res.data;\n\n        if (code === 200 && status === true) {\n          this.setState({\n            forgetStatus: 1\n          });\n          toast.success(message, {\n            autoClose: 2000,\n            position: toast.POSITION.TOP_CENTER\n          });\n        } else {\n          toast.error(message, {\n            autoClose: 2000,\n            position: toast.POSITION.TOP_CENTER\n          });\n        }\n\n        console.log(res);\n      }, error => {\n        console.log(error);\n      });\n    };\n\n    this.sendCode = async values => {\n      await axios({\n        method: 'post',\n        url: `${this.state.url}/user/send_code`,\n        data: values\n      }).then(res => {\n        const {\n          code,\n          status,\n          message\n        } = res.data;\n\n        if (code === 200 && status === true) {\n          this.setState({\n            forgetStatus: 2\n          });\n          toast.success(message, {\n            autoClose: 2000,\n            position: toast.POSITION.TOP_CENTER\n          });\n        } else {\n          toast.error(message, {\n            autoClose: 2000,\n            position: toast.POSITION.TOP_CENTER\n          });\n        }\n\n        console.log(res);\n      }, error => {\n        console.log(error);\n      });\n    };\n\n    this.resetPassword = async values => {\n      await axios({\n        method: 'post',\n        url: `${this.state.url}/user/reset_password`,\n        data: values\n      }).then(res => {\n        const {\n          code,\n          status,\n          message\n        } = res.data;\n\n        if (code === 200 && status === true) {\n          this.setState({\n            forgetStatus: 0\n          });\n          history.push(\"/login\");\n          toast.success(message, {\n            autoClose: 2000,\n            position: toast.POSITION.TOP_CENTER\n          });\n        } else {\n          toast.error(message, {\n            autoClose: 2000,\n            position: toast.POSITION.TOP_CENTER\n          });\n        }\n\n        console.log(res);\n      }, error => {\n        console.log(error);\n      });\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(UserContext.Provider, {\n      value: { ...this.state,\n        getCategories: this.getCategories,\n        getCountries: this.getCountries,\n        userRegister: this.userRegister,\n        userLogin: this.userLogin,\n        userRefresh: this.userRefresh,\n        userLogout: this.userLogout,\n        changePassword: this.changePassword,\n        forgotPassword: this.forgotPassword,\n        sendCode: this.sendCode,\n        resetPassword: this.resetPassword\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 13\n      }\n    }, this.props.children);\n  }\n\n} // consumer\n\n\nconst UserConsumer = UserContext.Consumer;\nexport { UserConsumer, UserContext };\nexport default UserProvider;","map":{"version":3,"sources":["E:/CSR-master/src/client/context/user.js"],"names":["React","Component","createContext","history","axios","toast","configure","UserContext","UserProvider","state","url","categories","countries","user","loading","forgetStatus","componentDidMount","localStorage","getItem","setState","JSON","parse","getCategories","method","then","res","data","console","log","error","getCountries","map","item","name","userRegister","values","code","status","message","success","autoClose","position","POSITION","TOP_CENTER","push","userLogin","accessToken","token","type","photo","birthDate","country_id","dashboardUrl","window","open","setItem","stringify","userRefresh","userLogout","removeItem","changePassword","oldPassword","newPassword","headers","Authorization","forgotPassword","sendCode","resetPassword","render","props","children","UserConsumer","Consumer"],"mappings":"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","sourcesContent":["import React, {Component, createContext} from 'react';\nimport history from \"../../history\";\nimport axios from \"axios\";\n// importing toastify module\nimport {toast} from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\ntoast.configure();\n\n// context\nconst UserContext = createContext();\n\n// provider\nclass UserProvider extends Component {\n    state = {\n        url: \"https://joodya.com/crs/api/v1\",\n        categories: [],\n        countries: [],\n        user: {},\n        loading: false,\n        forgetStatus: 0\n    }\n    \n    componentDidMount = () => {\n        localStorage.getItem(\"user\")\n        ? this.setState({user: JSON.parse(localStorage.getItem(\"user\"))})\n        : this.setState({user: {}}) ;\n    }\n\n    getCategories = async () => {\n        await axios({\n            method: 'get',\n            url: `${this.state.url}/user/register`,\n        }).then(\n            res => {\n                const {data} = res.data;\n                const {categories} = data;\n                this.setState({categories});\n                console.log(res);\n            },\n            error => {\n                console.log(error);\n            }\n        )\n    }\n\n    getCountries  = async () => {\n        await axios({\n            method: 'get',\n            url: \"https://restcountries.eu/rest/v2/all\",\n        }).then(\n            res => {\n                const countries = res.data.map(item=>{\n                    return item.name\n                })\n                this.setState({countries});\n                console.log(res);\n            },\n            error => {\n                console.log(error);\n            }\n        )\n    }\n\n\n    userRegister = async (values) => {\n        this.setState({loading: true});\n        console.log(\"userRegister\", values);\n        await axios({\n        method: 'post',\n        url: `${this.state.url}/user/register`,\n        data: {...values},\n        }).then(\n            res => {\n                const {code, status, message} = res.data;\n                if(code == 200 && status === true){\n                    toast.success(message, {autoClose:2000, position: toast.POSITION.TOP_CENTER});\n                    history.push(\"/login\");\n                }else{\n                    toast.error(message, {position: toast.POSITION.TOP_CENTER});\n                }\n                console.log(res);\n            },\n            error => {\n                console.log(error);\n            }\n        )\n        this.setState({loading: false});\n    }\n\n    userLogin = async (values) => {\n        this.setState({loading: true});\n        await axios({\n            method: 'post',\n            url: `${this.state.url}/user/login`,\n            data: {...values},\n        }).then(\n            res => {\n                const {code, status, message, accessToken: token, user} = res.data;\n                if(code === \"200\" && status === true){\n                    const {type, photo, name, birthDate, country_id} = user;\n                    this.setState({\n                        user: {token, ...user}\n                    });\n                    const dashboardUrl = (type === \"2\"? \"/employee/dashboard\" : \"/employer/dashboard\");\n                    type===\"0\"? window.open('/admin', '_blank') : history.push(dashboardUrl);\n                    localStorage.setItem(\"user\", JSON.stringify({token, type, photo, name, birthDate, country_id}));\n                    toast.success(message, {autoClose:2000, position: toast.POSITION.TOP_CENTER});\n                }else{\n                    toast.error(message, {position: toast.POSITION.TOP_CENTER});\n                }\n                console.log(res);\n                \n            },\n            error => {\n                toast.error(\"There was an error. Please try again...\", {autoClose:2000, position: toast.POSITION.TOP_CENTER})\n                console.log(error);\n            }\n        )\n        this.setState({loading: false});\n    }\n\n    userRefresh = async (user) => {\n        const {type, photo, name, birthDate, country_id} = user;\n        const {token} = this.state.user;\n        await this.setState({user: {token, ...user}});\n        localStorage.setItem(\"user\", JSON.stringify({token, type, photo, name, birthDate, country_id}));\n    }\n\n    userLogout = () => {\n        this.setState({user: {}});\n        localStorage.removeItem(\"user\");\n        history.push(\"/login\");\n    };\n\n    changePassword  = async ({oldPassword, newPassword}) => {\n        await axios({\n            method: 'post',\n            url: `${this.state.url}/change_password`,\n            headers: {Authorization: `Bearer ${this.state.user.token}`},\n            data: {\"old_password\": oldPassword, \"new_password\": newPassword},\n        }).then(\n            res => {\n                const {code, status, message} = res.data;\n                if(code === 200 && status === true){\n                    toast.success(message, {autoClose:2000, position: toast.POSITION.TOP_CENTER});\n                }else{\n                    toast.error(message, {autoClose:2000, position: toast.POSITION.TOP_CENTER})\n                }\n                console.log(res);\n            },\n            error => {\n                console.log(error);\n            }\n        )\n    }\n\n    forgotPassword  = async (values) => {\n        await axios({\n            method: 'post',\n            url: `${this.state.url}/user/forgot_password`,\n            data: values,\n        }).then(\n            res => {\n                const {code, status, message} = res.data;\n                if(code === 200 && status === true){\n                    this.setState({forgetStatus: 1})\n                    toast.success(message, {autoClose:2000, position: toast.POSITION.TOP_CENTER});\n                }else{\n                    toast.error(message, {autoClose:2000, position: toast.POSITION.TOP_CENTER})\n                }\n                console.log(res);\n            },\n            error => {\n                console.log(error);\n            }\n        )\n    }\n\n    sendCode  = async (values) => {\n        await axios({\n            method: 'post',\n            url: `${this.state.url}/user/send_code`,\n            data: values,\n        }).then(\n            res => {\n                const {code, status, message} = res.data;\n                if(code === 200 && status === true){\n                    this.setState({forgetStatus: 2})\n                    toast.success(message, {autoClose:2000, position: toast.POSITION.TOP_CENTER});\n                }else{\n                    toast.error(message, {autoClose:2000, position: toast.POSITION.TOP_CENTER})\n                }\n                console.log(res);\n            },\n            error => {\n                console.log(error);\n            }\n        )\n    }\n\n    resetPassword  = async (values) => {\n        await axios({\n            method: 'post',\n            url: `${this.state.url}/user/reset_password`,\n            data: values,\n        }).then(\n            res => {\n                const {code, status, message} = res.data;\n                if(code === 200 && status === true){\n                    this.setState({forgetStatus: 0})\n                    history.push(\"/login\");\n                    toast.success(message, {autoClose:2000, position: toast.POSITION.TOP_CENTER});\n                }else{\n                    toast.error(message, {autoClose:2000, position: toast.POSITION.TOP_CENTER})\n                }\n                console.log(res);\n            },\n            error => {\n                console.log(error);\n            }\n        )\n    }\n\n    render() {\n        return (\n            <UserContext.Provider value={{\n                ...this.state,\n                getCategories: this.getCategories,\n                getCountries: this.getCountries,\n                userRegister: this.userRegister,\n                userLogin: this.userLogin,\n                userRefresh : this.userRefresh,\n                userLogout: this.userLogout,\n                changePassword: this.changePassword,\n\n                forgotPassword: this.forgotPassword,\n                sendCode: this.sendCode,\n                resetPassword: this.resetPassword\n            }}>\n                {this.props.children}\n            </UserContext.Provider>\n        )\n    }\n}\n\n// consumer\nconst UserConsumer = UserContext.Consumer;\n\nexport {UserConsumer, UserContext};\nexport default UserProvider;"]},"metadata":{},"sourceType":"module"}