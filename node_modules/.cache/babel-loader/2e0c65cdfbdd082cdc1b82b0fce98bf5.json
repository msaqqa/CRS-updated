{"ast":null,"code":"import _objectSpread from\"E:\\\\CSR-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"E:\\\\CSR-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"E:\\\\CSR-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"E:\\\\CSR-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\CSR-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"E:\\\\CSR-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"E:\\\\CSR-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{Table}from'antd';import'antd/dist/antd.css';import{Link}from'react-router-dom';import{Modal}from'react-bootstrap';import{itemRender,onShowSizeChange}from\"../../../components/paginationfunction\";import{Formik,Form,Field,ErrorMessage}from'formik';import*as Yup from'yup';import IMG01 from'../../../assets/images/specialities-01.png';// context\nimport{AdminContext}from\"../../../context/admin\";var SubCategories=/*#__PURE__*/function(_Component){_inherits(SubCategories,_Component);var _super=_createSuper(SubCategories);function SubCategories(){var _this;_classCallCheck(this,SubCategories);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={show:null,isEdit:false,id:\"\",name:\"\",parent:\"\",image:\"\"};_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var id,_this$context,subCategories,getSubCategories;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:id=_this.props.match.params.id;_this$context=_this.context,subCategories=_this$context.subCategories,getSubCategories=_this$context.getSubCategories;if(subCategories.length===0){getSubCategories(id);};case 4:case\"end\":return _context.stop();}}},_callee);}));_this.handleClose=function(){_this.setState({show:false});};_this.handleShow=function(id){_this.setState({show:id});};_this.handleAddBtn=function(){_this.setState({id:\"\",name:\"\",parent:\"\",image:\"\",isEdit:false});_this.handleShow('edit');};_this.handleEditBtn=function(_ref2){var id=_ref2.id,name=_ref2.name,parent=_ref2.parent,image=_ref2.image;_this.setState({id:id,name:name,parent:parent,image:image,isEdit:true});_this.handleShow('edit');};_this.handleDeleteBtn=function(id){_this.setState({id:id});_this.handleShow('delete');};_this.handleSubmitDelete=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var id,pageId,_this$context2,deleteCategory,getSubCategories;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:id=_this.state.id;pageId=_this.props.match.params.id;_this$context2=_this.context,deleteCategory=_this$context2.deleteCategory,getSubCategories=_this$context2.getSubCategories;_context2.next=5;return deleteCategory(id);case 5:getSubCategories(pageId);_this.handleClose();case 7:case\"end\":return _context2.stop();}}},_callee2);}));_this.initialValues=function(){return{name:_this.state.name||'',parent:_this.state.parent||'',image:null};};_this.validationSchema=function(){var SUPPORTED_FORMATS=[\"image/jpg\",\"image/jpeg\",\"image/gif\",\"image/png\"];return Yup.object().shape({name:Yup.string().required(\"Required\"),parent:Yup.string().required(\"Required\"),image:Yup.mixed().required(\"Required\").test(\"fileFormat\",\"Unsupported Format\",function(value){return value&&SUPPORTED_FORMATS.includes(value.type);})});};_this.handleSubmit=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(values){var id,pageId,_this$context3,updateCategory,addCategory,getSubCategories;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(values);id=_this.state.id;pageId=_this.props.match.params.id;_this$context3=_this.context,updateCategory=_this$context3.updateCategory,addCategory=_this$context3.addCategory,getSubCategories=_this$context3.getSubCategories;if(!_this.state.isEdit){_context3.next=9;break;}_context3.next=7;return updateCategory(_objectSpread({id:id},values));case 7:_context3.next=11;break;case 9:_context3.next=11;return addCategory(values);case 11:getSubCategories(pageId);_this.handleClose();case 13:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x){return _ref4.apply(this,arguments);};}();return _this;}_createClass(SubCategories,[{key:\"render\",value:function render(){var _this2=this;var _this$context4=this.context,subCategories=_this$context4.subCategories,categories=_this$context4.categories;var data=subCategories;var columns=[{title:'#',dataIndex:'id',sorter:function sorter(a,b){return a.id.length-b.id.length;}},{title:'Category',dataIndex:'name',render:function render(text,_ref5){var image=_ref5.image,name=_ref5.name,id=_ref5.id;var imageUrl=image?\"http://excodeteam.com/crs/public/images/\".concat(image):IMG01;return/*#__PURE__*/React.createElement(\"h2\",{className:\"table-avatar\"},/*#__PURE__*/React.createElement(Link,{to:\"#\",className:\"avatar avatar-sm mr-2\"},/*#__PURE__*/React.createElement(\"img\",{src:imageUrl,className:\"avatar-img\",alt:\"\"})),/*#__PURE__*/React.createElement(Link,{to:\"#\"},name));},sorter:function sorter(a,b){return a.name.length-b.name.length;}},{title:'Actions',dataIndex:'id',render:function render(id,record){return/*#__PURE__*/React.createElement(\"div\",{className:\"actions\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-sm bg-success-light\",onClick:function onClick(){return _this2.handleEditBtn(record);}},/*#__PURE__*/React.createElement(\"i\",{className:\"fe fe-pencil\"}),\" Edit\"),/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-sm bg-danger-light\",onClick:function onClick(){return _this2.handleDeleteBtn(id);}},/*#__PURE__*/React.createElement(\"i\",{className:\"fe fe-trash\"}),\" Delete\"));}}];return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"page-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"content container-fluid\"},/*#__PURE__*/React.createElement(\"div\",{className:\"page-header\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-7 col-auto\"},/*#__PURE__*/React.createElement(\"h3\",{className:\"page-title\"},\"Sub Categories\"),/*#__PURE__*/React.createElement(\"ul\",{className:\"breadcrumb\"},/*#__PURE__*/React.createElement(\"li\",{className:\"breadcrumb-item\"},/*#__PURE__*/React.createElement(Link,{to:\"/admin\"},\"Dashboard\")),/*#__PURE__*/React.createElement(\"li\",{className:\"breadcrumb-item active\"},/*#__PURE__*/React.createElement(Link,{to:\"/admin/categories\"},\"Categories\")),/*#__PURE__*/React.createElement(\"li\",{className:\"breadcrumb-item active\"},\"Sub Categories\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-5 col\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-primary float-right mt-2\",onClick:this.handleAddBtn},\"Add\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-body\"},/*#__PURE__*/React.createElement(\"div\",{className:\"table-responsive\"},/*#__PURE__*/React.createElement(Table,{className:\"table-striped\",style:{overflowX:'auto'},columns:columns// bordered\n,dataSource:data,ascend:true,rowKey:function rowKey(record){return record.id;},showSizeChanger:true,pagination:{total:data.length,showTotal:function showTotal(total,range){return\"Showing \".concat(range[0],\" to \").concat(range[1],\" of \").concat(total,\" entries\");},showSizeChanger:true,onShowSizeChange:onShowSizeChange,itemRender:itemRender}}))))))),/*#__PURE__*/React.createElement(Modal,{show:this.state.show==='edit',onHide:this.handleClose,centered:true},/*#__PURE__*/React.createElement(Modal.Header,{closeButton:true},/*#__PURE__*/React.createElement(Modal.Title,null,/*#__PURE__*/React.createElement(\"h5\",{className:\"modal-title\"},\"Category\"))),/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(Formik,{initialValues:this.initialValues(),validationSchema:this.validationSchema,onSubmit:this.handleSubmit,validateOnChange:false,enableReinitialize:true},function(formik){var setFieldValue=formik.setFieldValue;return/*#__PURE__*/React.createElement(Form,null,/*#__PURE__*/React.createElement(\"div\",{className:\"row form-row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 col-sm-6\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"Category Name\"),/*#__PURE__*/React.createElement(Field,{type:\"text\",name:\"name\",className:\"form-control\"}),/*#__PURE__*/React.createElement(ErrorMessage,{name:\"name\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 col-sm-6\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"Main Category\"),/*#__PURE__*/React.createElement(Field,{as:\"select\",name:\"parent\",className:\"form-control\"},/*#__PURE__*/React.createElement(\"option\",{value:\"\",disabled:true},\"Select Parent Category\"),/*#__PURE__*/React.createElement(\"option\",{value:\"0\"},\"Main Category\"),categories.map(function(category){return/*#__PURE__*/React.createElement(\"option\",{key:category.id,value:category.id},category.name);})),/*#__PURE__*/React.createElement(ErrorMessage,{name:\"parent\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"Image\"),/*#__PURE__*/React.createElement(Field,{type:\"file\",name:\"file\",className:\"form-control\",onChange:function onChange(event){setFieldValue(\"image\",event.currentTarget.files[0]);}}),/*#__PURE__*/React.createElement(ErrorMessage,{name:\"image\"})))),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-primary btn-block\"},\"Save Changes\"));}))),/*#__PURE__*/React.createElement(Modal,{show:this.state.show==='delete',onHide:this.handleClose,centered:true},/*#__PURE__*/React.createElement(Modal.Body,{className:\"text-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-content p-2\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"modal-title\"},\"Delete\"),/*#__PURE__*/React.createElement(\"p\",{className:\"mb-4\"},\"Are you sure want to delete?\"),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-primary\",onClick:this.handleSubmitDelete},\"Save \"),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-danger\",\"data-dismiss\":\"modal\",onClick:function onClick(){return _this2.handleClose();}},\"Close\"))))));}}]);return SubCategories;}(Component);SubCategories.contextType=AdminContext;export default SubCategories;","map":{"version":3,"sources":["E:/CSR-master/src/admin/components/categories/subcategories/index.jsx"],"names":["React","Component","Table","Link","Modal","itemRender","onShowSizeChange","Formik","Form","Field","ErrorMessage","Yup","IMG01","AdminContext","SubCategories","state","show","isEdit","id","name","parent","image","componentDidMount","props","match","params","context","subCategories","getSubCategories","length","handleClose","setState","handleShow","handleAddBtn","handleEditBtn","handleDeleteBtn","handleSubmitDelete","pageId","deleteCategory","initialValues","validationSchema","SUPPORTED_FORMATS","object","shape","string","required","mixed","test","value","includes","type","handleSubmit","values","console","log","updateCategory","addCategory","categories","data","columns","title","dataIndex","sorter","a","b","render","text","imageUrl","record","overflowX","total","showTotal","range","showSizeChanger","formik","setFieldValue","map","category","event","currentTarget","files","contextType"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Table } from 'antd';\nimport 'antd/dist/antd.css';\nimport { Link } from 'react-router-dom';\nimport { Modal } from 'react-bootstrap';\nimport { itemRender, onShowSizeChange } from \"../../../components/paginationfunction\";\nimport { Formik, Form, Field, ErrorMessage } from 'formik';\nimport * as Yup from 'yup';\nimport IMG01 from '../../../assets/images/specialities-01.png';\n// context\nimport { AdminContext } from \"../../../context/admin\";\n\nclass SubCategories extends Component {\n  state = {\n    show: null,\n    isEdit: false,\n    id: \"\",\n    name: \"\",\n    parent: \"\",\n    image: \"\",\n  }\n\n  componentDidMount = async () => {\n    const { id } = this.props.match.params;\n    const { subCategories, getSubCategories } = this.context;\n    if (subCategories.length === 0) { getSubCategories(id) };\n  }\n\n  handleClose = () => {\n    this.setState({\n      show: false\n    });\n  }\n\n  handleShow = (id) => {\n    this.setState({\n      show: id\n    });\n  }\n\n  handleAddBtn = () => {\n    this.setState({\n      id: \"\",\n      name: \"\",\n      parent: \"\",\n      image: \"\",\n      isEdit: false\n    });\n    this.handleShow('edit');\n  }\n\n  handleEditBtn = ({ id, name, parent, image }) => {\n    this.setState({\n      id,\n      name,\n      parent,\n      image,\n      isEdit: true\n    });\n    this.handleShow('edit');\n  }\n\n  handleDeleteBtn = (id) => {\n    this.setState({ id });\n    this.handleShow('delete');\n  }\n\n  handleSubmitDelete = async () => {\n    const { id } = this.state;\n    const pageId = this.props.match.params.id;\n    const { deleteCategory, getSubCategories } = this.context;\n    await deleteCategory(id);\n    getSubCategories(pageId);\n    this.handleClose();\n  }\n\n  initialValues = () => {\n    return {\n      name: this.state.name || '',\n      parent: this.state.parent || '',\n      image: null,\n    }\n  }\n\n  validationSchema = () => {\n    const SUPPORTED_FORMATS = [\n      \"image/jpg\",\n      \"image/jpeg\",\n      \"image/gif\",\n      \"image/png\"\n    ];\n\n    return Yup.object().shape({\n      name: Yup.string().required(\"Required\"),\n      parent: Yup.string().required(\"Required\"),\n      image: Yup\n        .mixed()\n        .required(\"Required\")\n        .test(\n          \"fileFormat\",\n          \"Unsupported Format\",\n          value => value && SUPPORTED_FORMATS.includes(value.type)\n        )\n    });\n  }\n\n  handleSubmit = async (values) => {\n    console.log(values);\n    const { id } = this.state;\n    const pageId = this.props.match.params.id;\n    const { updateCategory, addCategory, getSubCategories } = this.context;\n    this.state.isEdit ? await updateCategory({ id, ...values }) : await addCategory(values);\n    getSubCategories(pageId);\n    this.handleClose();\n  }\n\n  render() {\n    const { subCategories, categories } = this.context;\n    const data = subCategories;\n\n    const columns = [\n      {\n        title: '#',\n        dataIndex: 'id',\n        sorter: (a, b) => a.id.length - b.id.length,\n      },\n      {\n        title: 'Category',\n        dataIndex: 'name',\n        render: (text, { image, name, id }) => {\n          const imageUrl = image ? `http://excodeteam.com/crs/public/images/${image}` : IMG01;\n          return (\n            <h2 className=\"table-avatar\">\n              <Link to=\"#\" className=\"avatar avatar-sm mr-2\"><img src={imageUrl} className=\"avatar-img\" alt=\"\" /></Link>\n              <Link to=\"#\">{name}</Link>\n            </h2>\n          )\n        },\n        sorter: (a, b) => a.name.length - b.name.length,\n      },\n      {\n        title: 'Actions',\n        dataIndex: 'id',\n        render: (id, record) => (\n          <div className=\"actions\">\n            <button className=\"btn btn-sm bg-success-light\" onClick={() => this.handleEditBtn(record)}><i className=\"fe fe-pencil\"></i> Edit</button>\n            <button className=\"btn btn-sm bg-danger-light\" onClick={() => this.handleDeleteBtn(id)}><i className=\"fe fe-trash\"></i> Delete</button>\n          </div>\n        ),\n      },\n    ]\n\n    return (\n      <>\n        <div className=\"page-wrapper\">\n          <div className=\"content container-fluid\">\n\n            <div className=\"page-header\">\n              <div className=\"row\">\n                <div className=\"col-sm-7 col-auto\">\n                  <h3 className=\"page-title\">Sub Categories</h3>\n                  <ul className=\"breadcrumb\">\n                    <li className=\"breadcrumb-item\"><Link to=\"/admin\">Dashboard</Link></li>\n                    <li className=\"breadcrumb-item active\"><Link to=\"/admin/categories\">Categories</Link></li>\n                    <li className=\"breadcrumb-item active\">Sub Categories</li>\n                  </ul>\n                </div>\n                <div className=\"col-sm-5 col\">\n                  <button className=\"btn btn-primary float-right mt-2\" onClick={this.handleAddBtn}>Add</button>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"row\">\n              <div className=\"col-md-12\">\n                <div className=\"card\">\n                  <div className=\"card-body\">\n                    <div className=\"table-responsive\">\n                      <Table className=\"table-striped\"\n                        style={{ overflowX: 'auto' }}\n                        columns={columns}\n                        // bordered\n                        dataSource={data}\n                        ascend={true}\n                        rowKey={record => record.id}\n                        showSizeChanger={true}\n                        pagination={{\n                          total: data.length,\n                          showTotal: (total, range) => `Showing ${range[0]} to ${range[1]} of ${total} entries`,\n                          showSizeChanger: true, onShowSizeChange: onShowSizeChange, itemRender: itemRender\n                        }}\n                      />\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Edit Modal */}\n          <Modal show={this.state.show === 'edit'} onHide={this.handleClose} centered>\n            <Modal.Header closeButton>\n              <Modal.Title><h5 className=\"modal-title\">Category</h5></Modal.Title>\n            </Modal.Header>\n            <Modal.Body>\n              <Formik\n                initialValues={this.initialValues()}\n                validationSchema={this.validationSchema}\n                onSubmit={this.handleSubmit}\n                validateOnChange={false}\n                enableReinitialize={true}\n              >\n                {(formik) => {\n                  const { setFieldValue } = formik;\n                  return (\n                    <Form>\n                      <div className=\"row form-row\">\n                        <div className=\"col-12 col-sm-6\">\n                          <div className=\"form-group\">\n                            <label>Category Name</label>\n                            <Field type=\"text\" name=\"name\" className=\"form-control\" />\n                            <ErrorMessage name=\"name\" />\n                          </div>\n                        </div>\n                        <div className=\"col-12 col-sm-6\">\n                          <div className=\"form-group\">\n                            <label>Main Category</label>\n                            <Field as=\"select\" name=\"parent\" className=\"form-control\">\n                              <option value=\"\" disabled>Select Parent Category</option>\n                              <option value=\"0\">Main Category</option>\n                              {\n                                categories.map((category) => {\n                                  return (\n                                    <option key={category.id} value={category.id}>\n                                      {category.name}\n                                    </option>\n                                  );\n                                })\n                              }\n                            </Field>\n                            <ErrorMessage name=\"parent\" />\n                          </div>\n                        </div>\n                        <div className=\"col-12\">\n                          <div className=\"form-group\">\n                            <label>Image</label>\n                            <Field type=\"file\" name=\"file\" className=\"form-control\" onChange={(event) => {\n                              setFieldValue(\"image\", event.currentTarget.files[0]);\n                            }}\n                            />\n                            <ErrorMessage name=\"image\" />\n                          </div>\n                        </div>\n                      </div>\n                      <button type=\"submit\" className=\"btn btn-primary btn-block\">Save Changes</button>\n                    </Form>\n                  )\n                }}\n              </Formik>\n            </Modal.Body>\n          </Modal>\n          {/* Edit Modal */}\n\n          {/* Delete Modal */}\n          <Modal show={this.state.show === 'delete'} onHide={this.handleClose} centered>\n            <Modal.Body className=\"text-center\">\n              <div className=\"form-content p-2\">\n                <h4 className=\"modal-title\">Delete</h4>\n                <p className=\"mb-4\">Are you sure want to delete?</p>\n                <button type=\"button\" className=\"btn btn-primary\" onClick={this.handleSubmitDelete}>Save </button>\n                <button type=\"button\" className=\"btn btn-danger\" data-dismiss=\"modal\" onClick={() => this.handleClose()}>Close</button>\n              </div>\n            </Modal.Body>\n          </Modal>\n          {/* Delete Modal */}\n        </div>\n      </>\n    )\n  }\n}\n\nSubCategories.contextType = AdminContext;\nexport default SubCategories;"]},"metadata":{},"sourceType":"module"}